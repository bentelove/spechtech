// components/TelegramAppContent.tsx
'use client';

import { useState, useEffect } from 'react';
import { useLaunchParams } from '@telegram-apps/sdk-react';

export default function TelegramAppContent() {
  const launchParams = useLaunchParams();
  const [status, setStatus] = useState('‚è≥ –ó–∞–≥—Ä—É–∂–∞–µ–º...');

  useEffect(() => {
    console.log('DEBUG - launchParams –æ—Ç SDK:', launchParams);
    console.log('DEBUG - –¢–∏–ø launchParams:', typeof launchParams);
    
    if (launchParams && typeof launchParams === 'object') {
      console.log('DEBUG - –ö–ª—é—á–∏ –≤ launchParams:', Object.keys(launchParams));
      
      if (launchParams.user) {
        console.log('DEBUG - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω:', launchParams.user);
        setStatus(`‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–ª—É—á–µ–Ω—ã! –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${JSON.stringify(launchParams.user, null, 2)}`);
      } else {
        setStatus('‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ launchParams');
      }
    } else if (launchParams === undefined) {
      setStatus('‚ö†Ô∏è launchParams = undefined');
    } else {
      setStatus(`‚ö†Ô∏è –ù–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç launchParams: ${typeof launchParams}`);
    }
  }, [launchParams]);

  return (
    <main style={{ padding: '20px', fontFamily: 'sans-serif' }}>
      <h1>üõ†Ô∏è –û—Ç–ª–∞–¥–∫–∞ Telegram Mini App</h1>
      
      <div style={{
        background: '#f8f9fa',
        border: '1px solid #dee2e6',
        borderRadius: '12px',
        padding: '20px',
        marginTop: '20px',
        fontFamily: 'monospace',
        whiteSpace: 'pre-wrap',
        wordBreak: 'break-all'
      }}>
        <h3>–°—Ç–∞—Ç—É—Å:</h3>
        <p>{status}</p>
        
        <h3 style={{ marginTop: '20px' }}>Raw –¥–∞–Ω–Ω—ã–µ –æ—Ç SDK:</h3>
        <pre style={{
          background: '#e9ecef',
          padding: '10px',
          borderRadius: '6px',
          fontSize: '0.8em',
          maxHeight: '300px',
          overflow: 'auto'
        }}>
          {JSON.stringify(launchParams, null, 2)}
        </pre>
      </div>
      
      <div style={{ marginTop: '20px', fontSize: '0.9em', color: '#666' }}>
        <p>–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ (F12) –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏.</p>
      </div>
    </main>
  );
}